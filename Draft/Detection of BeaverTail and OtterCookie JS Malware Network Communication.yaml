title: Detection of BeaverTail and OtterCookie JS Malware Network Communication
id: 
status: draft
description: Detects network connections to known BeaverTail and OtterCookie malware C2 servers used by North Korean threat actors, which employ JavaScript-based malware distributed via malicious npm packages and blockchain smart contracts.
references:
  - https://blog.talosintelligence.com/beavertail-and-ottercookie/
  - https://thehackernews.com/2025/10/north-korean-hackers-combine-beavertail.html
  - https://thehackernews.com/2025/10/north-korean-hackers-use-etherhiding-to.html
  - https://thehackernews.com/2025/10/hackers-abuse-blockchain-smart.html
  - https://thehackernews.com/2025/05/ottercookie-v4-adds-vm-detection-and.html
  - https://www.aikido.dev/blog/malware-hiding-in-plain-sight-spying-on-north-korean-hackers
  - https://jp.security.ntt/insights_resources/tech_blog/ottercandy_malware_e/
author: 
date: 2025/10/28
logsource:
  category: network_connection
  product: firewall
detection:
  selection:
    dst_ip:
      - '45.95.147.222'
      - '45.95.147.223'
      - '45.95.147.224'
      - '45.95.147.225'
      - '45.95.147.226'
      - '185.215.113.19'
      - '193.142.146.119'
      - '193.142.146.120'
      - '193.142.146.121'
      - '193.142.146.122'
      - '193.142.146.123'
      - '193.142.146.124'
      - '193.142.146.125'
    dst_host:
      - 'api.microsoftsub.com'
      - 'api.windowssub.com'
      - 'api.azureon.live'
      - 'api.azureedge.live'
      - 'api.microsoftedge.live'
      - 'cdn.azureonline[.]live'
      - 'cdn.azureedge[.]live'
      - 'cdn.microsoftedge[.]live'
  condition: selection
falsepositives:
  - Legitimate connections to Microsoft/Azure services that may use similar naming conventions should be reviewed and whitelisted if confirmed legitimate
  - Development or testing environments using similar domain patterns should be excluded
level: high
tags:
  - attack.command_and_control
  - attack.t1071.001
  - attack.t1583.001
  - attack.t1566.001
  - attack.t1204.002
  - attack.t1027
  - attack.lazarus
  - attack.beavertail
  - attack.ottercookie