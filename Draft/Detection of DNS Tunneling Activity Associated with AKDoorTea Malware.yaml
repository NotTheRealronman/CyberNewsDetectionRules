title: Detection of DNS Tunneling Activity Associated with AKDoorTea Malware
id: 
status: draft
description: Detects DNS queries with suspiciously long subdomains and TXT record requests associated with AKDoorTea malware C2 communication
references:
  - https://thehackernews.com/2025/09/north-korean-hackers-use-new-akdoortea.html
  - https://cloud.google.com/blog/topics/threat-intelligence/dprk-adopts-etherhiding
  - https://thehackernews.com/2023/10/binances-smart-chain-exploited-in-new.html
author: 
date: 2025-01-21
logsource:
  category: dns
  product: null
  service: dns
detection:
  selection:
    query_type: 
      - 'TXT'
      - 'A'
      - 'AAAA'
    query:
      - '|re|.*\.akdoor.*'
      - '|re|.*\.binance.*'
      - '|re|.*\.bsc.*'
      - '|re|.*\.ether.*'
      - '|re|.*\.eth.*'
    query_length:
      - '> 100'
  condition: selection
falsepositives:
  - Legitimate DNS queries with long subdomains from CDN services
  - Normal cryptocurrency-related DNS queries in financial organizations
  - Blockchain-related DNS queries in cryptocurrency companies
level: medium
tags:
  - attack.command_and_control
  - attack.t1071.001
  - attack.t1071.004
  - attack.t1568.002
  - attack.t1573.001
  - attack.t1105
  - attack.t1027
  - attack-group.lazarus
  - attack-group.apt38
  - malware.akdoortea