title: Chaos Mesh GraphQL API Exploitation - Kubernetes Secret Creation
id:
status: draft
description: Detects exploitation of Chaos Mesh's GraphQL API vulnerability (CVE-2025-50104) where an attacker uses an insecure direct object reference (IDOR) to create a Kubernetes secret, a key step towards achieving remote code execution and cluster compromise.
references:
  - https://thehackernews.com/2025/09/chaos-mesh-critical-graphql-flaws.html
  - https://www.cve.org/CVERecord?id=CVE-2025-50104
author:
date: '2025-09-24'
logsource:
  category: application
  product: kubernetes
  service: api-server
detection:
  selection:
    verb: POST
    objectRef:
      resource: secrets
      namespace: chaos-testing
    requestURI: '/graphql'
    userAgent: '*'
    responseStatus: 201
  condition: selection
falsepositives:
  - Legitimate administrative activity creating secrets within the `chaos-testing` namespace via the GraphQL API. This should be rare and tightly controlled. Whitelisting known administrative user identities and source IPs is recommended.
level: high
tags:
  - attack.privilege_escalation
  - attack.defense_evasion
  - attack.t1611 # Escape to Host (potential technique if container escape occurs)
  - attack.t1612 # Build Image on Host (potential technique for persistence)
  - attack.t1059 # Command and Scripting Interpreter
  - cve.cve-2025-50104
  - vulnerability.chaos_mesh
  - attack.rce