title: WatchGuard VPN IKEv2 Out-of-Bounds Write Exploitation Attempt
id: 
status: draft
description: Detects potential exploitation attempts targeting CVE-2025-9242 in WatchGuard Fireware OS IKEv2 implementation, which allows unauthenticated remote attackers to execute arbitrary code via specially crafted IKEv2 packets
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-9242
  - https://www.watchguard.com/wgrd-psirt/advisory/wgsa-2025-00015
  - https://labs.watchtowr.com/yikes-watchguard-fireware-os-ikev2-out-of-bounds-write-cve-2025-9242/
author: 
date: 2025-01-19
logsource:
  category: network
  product: watchguard
  service: ikev2
detection:
  selection:
    dest_port: 
      - 500    # IKEv2 standard port
      - 4500   # IKEv2 NAT-T port
    protocol: udp
    event_type: 
      - "ikev2_exchange"
      - "vpn_authentication"
    status: 
      - "failed"
      - "malformed_packet"
      - "buffer_overflow"
  condition: selection
falsepositives:
  - Legitimate IKEv2 negotiation failures from misconfigured clients
  - Network scanning activities targeting VPN services
  - Normal IKEv2 protocol exchanges with packet fragmentation
level: high
tags:
  - attack.t1190
  - attack.t1203
  - attack.t1068
  - cve-2025-9242
  - watchguard
  - vpn
  - ikev2
  - exploitation