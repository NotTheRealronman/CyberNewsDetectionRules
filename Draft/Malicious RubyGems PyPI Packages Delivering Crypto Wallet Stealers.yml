title: Malicious RubyGems/PyPI Packages Delivering Crypto Wallet Stealers
id: 
status: draft
description: Detects installation patterns of malicious packages in RubyGems/PyPI ecosystems that deliver cross-platform wallet stealers targeting cryptocurrency credentials through typosquatted packages and post-install hooks.
references:
  - https://thehackernews.com/2025/08/rubygems-pypi-hit-by-malicious-packages.html
  - https://www.bleepingcomputer.com/news/security/over-500-malicious-pypi-rubygems-packages-target-crypto-wallets/
  - https://jfrog.com/blog/malicious-pypi-rubygems-packages-target-crypto-wallets/
author: 
date: 2025-08-09
logsource:
  category: process_creation
  product: linux
  service: 
detection:
  package_installation:
    CommandLine|contains|any:
      - 'gem install'
      - 'pip install'
    CommandLine|re: 
      - 'gem install (crypto|wallet|secure|blockchain)-[a-z0-9_]{5,12}'
      - 'pip install (pycryptowallet|securecoin|blockchainutils)'
  malicious_postinstall:
    ParentImage|endswith:
      - '/gem'
      - '/pip'
    CommandLine|contains|any:
      - 'curl -s'
      - 'wget -q'
      - 'chmod +x'
      - 'bash -c'
    CommandLine|re: 
      - 'https://github\.com/[a-z0-9_-]{10,20}/[a-z0-9_-]{10,20}/raw/main/install\.sh'
      - '/tmp/update_[a-z0-9]+\.sh'
  wallet_targeting:
    CommandLine|contains|any:
      - '~/.electrum/wallets'
      - '~/.bitcoin/wallet.dat'
      - '~/.ethereum/keystore'
      - '--datadir'
    CommandLine|re: 'grep -r "seed_phrase\|private_key"'
  condition: package_installation and (malicious_postinstall or wallet_targeting)
falsepositives:
  - Legitimate cryptocurrency wallet management tools
  - Blockchain development environments
level: critical
tags:
  - attack.t1195.002  # Supply Chain Compromise
  - attack.t1552.001  # Unsecured Credentials
  - attack.t1071.001  # HTTP C2
  - attack.t1059.004  # Unix Shell