title: Suspicious npm Package Publication Without 2FA or Using Long-Lived Tokens
id: 
status: draft
description: Detects suspicious npm package publication activities that may indicate supply chain attacks, particularly those bypassing 2FA requirements or using long-lived authentication tokens
references:
  - https://thehackernews.com/2025/09/github-mandates-2fa-and-short-lived.html
  - https://docs.npmjs.com/about-two-factor-authentication
  - https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/about-two-factor-authentication
author: 
date: 2025-01-20
logsource:
  category: application
  product: npm
  service: registry
detection:
  selection:
    event.action:
      - package.publish
      - package.modify
      - package.deprecate
    auth.method:
      - password_only
      - long_lived_token
      - legacy_token
  condition: selection
falsepositives:
  - Legacy systems or automation scripts that haven't been updated to use short-lived tokens
  - Developers temporarily bypassing 2FA during migration periods
  - Authorized maintenance activities with proper approval
level: high
tags:
  - attack.supply_chain_compromise
  - attack.t1195
  - attack.credential_access
  - attack.t1552
  - attack.persistence
  - attack.t1098