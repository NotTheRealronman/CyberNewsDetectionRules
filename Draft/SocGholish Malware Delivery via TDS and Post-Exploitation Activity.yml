title: SocGholish Malware Delivery via TDS and Post-Exploitation Activity  
id:  
status: draft  
description: Detects SocGholish malware delivery through Traffic Distribution Systems (TDS), JavaScript loader execution, and subsequent post-exploitation behaviors including forced authentication, scheduled tasks, and RansomHub deployment.  
references:  
  - https://thehackernews.com/2025/08/socgholish-malware-spread-via-ad-tools.html :cite[1]  
  - https://redcanary.com/threat-detection-report/threats/socgholish/ :cite[2]  
  - https://www.darktrace.com/blog/socgholish-from-loader-and-c2-activity-to-ransomhub-deployment :cite[5]  
author:  
date: 2025-08-08  
logsource:  
  category: process_creation  
  product: windows  
  service:  
detection:  
  initial_access:  
    ParentImage|endswith: '\wscript.exe'  
    ParentCommandLine|contains|all:  
      - '\AppData\Local\Temp'  
      - '.zip'  
      - 'update'  
      - '.js'  
    ParentCommandLine|re: '(Chrome|Edge|Firefox).*\.js'  # Browser update lures :cite[2]:cite[4]  
  homoglyph_evasion:  
    CommandLine|re: '.*[Uрdаte|Instаller].*\.(js|zip)'  # Homoglyph characters (Cyrillic р/а) :cite[2]  
  post_exploitation:  
    CommandLine|contains|any:  
      - 'schtasks /create'  # Persistence via scheduled tasks :cite[10]  
      - 'WebDAV-MiniRedir'  # Forced authentication via WebDAV :cite[5]  
      - 'Thumbs.scf'        # SCF file attacks for NTLM theft :cite[5]  
      - 'Python 3.12.0'     # Python backdoor installation :cite[2]  
  network_indicators:  
    DestinationIp|re: '35\.203\.175\.30|176\.53\.147\.97'  # TDS IPs (garagebevents[.]com, packedbrick[.]com) :cite[5]  
  condition: initial_access or (homoglyph_evasion and post_exploitation) or network_indicators  
falsepositives:  
  - Legitimate software updates from browser vendors  
  - Developer environments compiling JavaScript  
level: critical  
tags:  
  - attack.t1059.007  # JavaScript Execution  
  - attack.t1187       # Forced Authentication  
  - attack.t1053.005   # Scheduled Task  
  - attack.t1571       # Non-Standard Port (C2)  
  - attack.t1204.002   # User Execution  
