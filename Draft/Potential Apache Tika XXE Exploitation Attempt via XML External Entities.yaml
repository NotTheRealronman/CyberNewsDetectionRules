title: Potential Apache Tika XXE Exploitation Attempt via XML External Entities
id: 
status: draft
description: Detects potential exploitation attempts targeting the Apache Tika XXE vulnerability (CVE-2025-66516) by monitoring for XML external entity declarations and references in document processing requests.
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-66516
  - https://lists.apache.org/thread/s5x3k93nhbkqzztp1olxotoyjpdlps9k
  - https://www.imperva.com/learn/application-security/xxe-xml-external-entity/
  - https://www.cve.org/CVERecord?id=CVE-2025-54988
author: 
date: '2025-02-05'
logsource:
  category: web
  product: apache
  service: tika
detection:
  selection:
    cs-uri-stem|contains:
      - '/tika'
      - '/meta'
      - '/form'
      - '/rmeta'
    cs-uri-query|contains|all:
      - 'format='
      - 'xml'
  keywords:
    c-useragent|contains: 'Apache Tika'
  condition: selection or keywords
falsepositives:
  - Legitimate document processing workflows that use XML formats with standard DTDs
  - Development or testing environments where controlled XXE testing occurs
  - To reduce false positives, organizations should baseline normal XML document types processed by their Tika instances and create allowlists for known legitimate external entity sources.
level: high
tags:
  - attack.initial_access
  - attack.t1190
  - attack.impact
  - attack.t1486
  - cve.2025.66516
  - cve.2025.54988
  - attack.technique.t1190
  - attack.technique.t1486