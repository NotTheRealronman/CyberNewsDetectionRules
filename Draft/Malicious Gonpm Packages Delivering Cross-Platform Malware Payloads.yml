title: Malicious Go/npm Packages Delivering Cross-Platform Malware Payloads
id: 
status: draft
description: Detects installation patterns of malicious packages in Go/npm ecosystems that deliver cross-platform malware via PowerShell scripts, scheduled tasks, and network connections to C2 infrastructure.
references:
  - https://thehackernews.com/2025/08/malicious-go-npm-packages-deliver-cross.html
  - https://www.bleepingcomputer.com/news/security/17-malicious-npm-packages-caught-installing-password-stealers-rats/
  - https://jfrog.com/blog/malicious-go-packages-targeting-developers-with-cobolt-strike/
author: 
date: 2025-08-08
logsource:
  category: process_creation
  product: windows
  service: 
detection:
  installer_process:
    ParentImage|endswith:
      - '\go.exe'
      - '\npm.cmd'
      - '\node.exe'
    CommandLine|contains|any:
      - 'install'
      - 'get'
    CommandLine|re: 
      - 'go (get|install) (github|bitbucket)\.com/[a-z0-9_-]{8,15}/[a-z0-9_-]{10,20}'
      - 'npm install (express-?utils|fast-?api|color-?converter)@[0-9]+\.[0-9]+\.[0-9]+'
  payload_execution:
    Image|endswith: 
      - '\powershell.exe'
      - '\cmd.exe'
    CommandLine|re|any:
      - '-EncodedCommand [A-Za-z0-9+/]{100,}'
      - 'iex \(iwr .+\)'  # In-memory execution
      - 'Start-BitsTransfer .+; Expand-Archive .+; \\.+\.ps1'
    ParentImage|endswith: 
      - '\go.exe'
      - '\npm.cmd'
  persistence_mechanism:
    CommandLine|contains: 
      - 'schtasks /create /tn "NodeUpdate"'
      - 'New-ScheduledTaskAction -Execute'
      - 'Register-ScheduledTask'
  condition: installer_process and payload_execution and persistence_mechanism
falsepositives:
  - Legitimate package installation workflows
  - Build servers executing automated dependency installations
level: critical
tags:
  - attack.t1195    # Supply Chain Compromise
  - attack.t1059.001 # PowerShell
  - attack.t1053.005 # Scheduled Task
  - attack.t1105    # Ingress Tool Transfer
