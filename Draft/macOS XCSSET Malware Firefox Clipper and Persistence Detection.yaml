title: macOS XCSSET Malware Firefox Clipper and Persistence Detection
id: 
status: draft
description: Detects XCSSET malware variant targeting Firefox with clipper functionality and persistence mechanisms on macOS systems
references:
  - https://thehackernews.com/2025/09/new-macos-xcsset-variant-targets.html
  - https://attack.mitre.org/techniques/T1556/001/  # Credential API Hooking
  - https://attack.mitre.org/techniques/T1543/001/  # Launch Agent
  - https://attack.mitre.org/techniques/T1056/001/  # Keylogging
author: 
date: 2025-01-20
logsource:
  category: process_creation
  product: macos
  service: endpoint
detection:
  selection:
    Image|endswith:
      - '/firefox'
      - '/Firefox.app/Contents/MacOS/firefox'
    CommandLine|contains:
      - '--marionette'
      - '--remote-debugging-port'
    ParentImage|endswith:
      - '/launchd'
      - '/bash'
      - '/zsh'
  filter:
    Image|endswith: '/firefox'
    CommandLine|contains: '--headless'
  condition: selection and not filter
falsepositives:
  - Legitimate Firefox development or debugging activities
  - Automated testing frameworks using marionette
  - Security researchers conducting analysis
level: high
tags:
  - attack.credential_access
  - attack.t1556.001  # Credential API Hooking
  - attack.persistence
  - attack.t1543.001  # Launch Agent
  - attack.collection
  - attack.t1056.001  # Keylogging
  - attack.macos
  - attack.xcsset
  - attack.clipper