title: Suspicious Salesforce Authentication Activity - Potential Credential Harvesting
id:
status: draft
description: Detects patterns of failed authentication attempts and suspicious successful logins to Salesforce, potentially indicating a credential harvesting campaign as used by threat actors like UNC6040 and UNC6395.
references:
  - https://thehackernews.com/2025/09/fbi-warns-of-unc6040-and-unc6395.html
  - https://www.fbi.gov/wanted/cyber
author:
date: '2024-09-25'
logsource:
  category: application
  product: salesforce
  service: authentication
detection:
  selection:
    event_type: 'Login'
    status:
      - 'Failure'
      - 'Success'
  filter_success_useragent:
    status: 'Success'
    user_agent|contains:
      - 'python-requests'
      - 'Go-http-client'
      - 'curl'
  filter_failure_sourceip:
    status: 'Failure'
    source_ip|cidr:
      - '192.168.0.0/16'
      - '10.0.0.0/8'
      - '172.16.0.0/12'
  timeframe: 5m
  condition: selection and (filter_success_useragent or (filter_failure_sourceip and | count(status) by source_ip >= 10))
falsepositives:
  - Legitimate API integrations using automated tools may use similar user agents. These should be baselined and whitelisted.
  - Penetration testing or authorized security scanning activities.
  - New users or users with forgotten passwords may cause multiple failed login attempts.
level: high
tags:
  - attack.initial_access
  - attack.t1589.001 # Credentials from Web Browsers
  - attack.t1071.001 # Application Layer Protocol
  - attack.t1071.003 # Application Layer Protocol: Mail Protocols
  - attack.credential_access
  - attack.t1110 # Brute Force
  - cve.2025.12345 # Placeholder for any mentioned CVE
  - attack.t1566.001 # Phishing: Spearphishing Attachment
  - attack.t1566.002 # Phishing: Spearphishing Link
  - attack.t1204.002 # User Execution: Malicious File
  - car.2013-05-009 # Suspicious User Agent
  - car.2021-05-001 # Bulk exfiltration over web service