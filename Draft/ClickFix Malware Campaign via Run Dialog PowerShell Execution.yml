title: ClickFix Malware Campaign via Run Dialog PowerShell Execution
id: 
status: draft
description: Detects execution of obfuscated PowerShell commands via Windows Run dialog triggered by ClickFix social engineering attacks. Matches clipboard hijacking, suspicious PowerShell parameters, and subsequent malware deployment patterns.
references:
  - https://thehackernews.com/2025/08/clickfix-malware-campaign-exploits.html
  - https://sec.okta.com/articles/2025/07/how-this-clickfix-campaign-leads-to-redline-stealer/
  - https://krebsonsecurity.com/2025/03/clickfix-how-to-infect-your-pc-in-three-easy-steps/
author: 
date: 2025-08-06
logsource:
  category: process_creation
  product: windows
  service: powershell
detection:
  selection:
    ParentCommandLine|contains: 
      - '\Run\Dll32.exe'  # Execution via Run dialog
      - 'explorer.exe'    # Common parent process
    CommandLine|contains|all:
      - '-WindowStyle Hidden'
      - '-c '             # Obfuscated commands
      - 'Invoke-WebRequest'
      - 'iex'             # Invoke-Expression
    CommandLine|re: 
      - '(?i)\$[a-z]{2,3}=.*;&\$[a-z]{2,3}'  # Variable-based obfuscation
      - 'oktahu\.org'     # IOC from payload :cite[2]
  file_creation:
    TargetPath|re: 
      - '.*\\AppData\\(Local|Roaming)\\.*\.(zip|exe|a3x)'  # Malware artifacts
      - '.*\\ProgramData\\fastpatch\\.*'                   # Persistence path :cite[2]
  condition: selection and file_creation
falsepositives:
  - Legitimate system administration scripts using similar obfuscation
  - Developer environments executing dynamic code
level: critical
tags:
  - attack.t1059.001    # PowerShell
  - attack.t1204.002    # User Execution
  - attack.t1546.013    # Scheduled Task
  - attack.t1566        # Phishing
  - attack.t1105        # Ingress Tool Transfer
